---
layout: post
title: Odysseus
description: "Should've saved your blobs..."
category: articles
tags: [iBEC, iBoot, iBSS, iTunes, idevicerestore, APTicket, SHSH Blobs, downgrade, A5, A6, ios-kexec-utils, kloader]
image:
    feature: APTicket_in_blob.png
---

# Disclaimer
This method currently works on only 32bit devices (iPhone 5 and 5C and below, all the iPods, and the iPad 4 and below). Also, if your SHSH blobs and APTickets are invalid in any way, this restore will fail and you will be forced to upgrade to the latest signed firmware, which may not currently be jailbreakable. [Xerub](http://twitter.com/xerub) or myself are absolutely not responsible for any damage you do to your device or current firmware. There may also be problems with the baseband if you attempt to downgrade to a firmware with a different baseband than you are currently on. Make sure you check the baseband. I cannot stress this enough. If you only know how to click a "jailbreak" button and do not know much about the underlying components of iOS, please do not try this as you will probably mess up your device. I only recommend experienced developer use this tool.

# What is this?
Odysseus is a program written by [xerub](http://twitter.com/xerub) that downgrades your 32bit A5+ devices. This method also works on A4, but why use this on A4 when you have [limera1n](http://dayt0n.github.io/articles/what-is-limera1n/)? Anyway, this method uses a tool incuded within [winocm](http://twitter.com/winocm)'s ios-kexec-utils. The tool, kloader, is a CLI that you can run on an iOS device that loads an (decrypted) image. It requires a jailbreak currently to run kloader on the device. Odyssseus is fairly simple for the experienced user. It is a tool that allows you to bootstrap a pwned iBSS and then initiate a restore using [iDeviceRestore](https://github.com/libimobiledevice/idevicerestore) with a custom iPSW that will effectively downgrade/upgrade/restore to any firmware you have valid blobs and an APTicket for. 

## Requirements
* A jailbroken with the latest untether that has tfp0 enabled. tfp0 enabled untethers include evasi0n, TaiG, and the latest Pangu. For example, early versions of Pangu did not have tfp0 enabled. 

* OpenSSH installed on target device

* Valid SHSH blobs with valid APTickets. Odysseus comes with a native SHSH blob validator called `validate`.

## Instructions
### 1. Download the iPSW file you want to downgrade to [here](http://ipsw.me). 

### 2. Validate the Blob(s)
  * Convert the .shsh file you have to the xml format:

  {% highlight c %}
DaytonHasty$ zcat myblob.shsh > myblob.plist
DaytonHasty$ plutil -convert xml1 myblob.plist
  {% endhighlight %}

  * Extract the BuildManifest.plist file from the iPSW file you downloaded

  {% highlight c %}
DaytonHasty$ unzip downloaded.ipsw BuildManifest.plist
DaytonHasty$ ./validate myblob.plist BuildManifest.plist
  {% endhighlight %}

  * If you get a bunch of "ERROR"s and "WARNING"s, your blob/APTicket is not valid and cannot be used. Stop using this method now to prevent inevitable forced upgrades. However, if you get a "WARNING" for an UpdateRamdisk, you should be fine.

### 3. Build the custom iPSW
  * This may take a while.. Use the `-memory` parameter only if your computer has greater than or equal to four gigabytes of RAM. Also make sure you have the correct bundle in FirmwareBundles/.

  {% highlight c %}
  DaytonHasty$ ./ipsw downloaded.ipsw custom.ipsw -memory
  {% endhighlight %}

  * Extract the iBSS from the custom iPSW you just built.
  
  {% highlight c %}
DaytonHasty$ unzip -j custom.ipsw 'Firmware/dfu/iBSS*'
DaytonHasty$ ./xpwntool iBSS-whatever-it-is-called pwnediBSS
  {% endhighlight %}

### 4. Copy kloader and pwnediBSS to the device

{% highlight c %}
DaytonHasty$ scp kloader pwnediBSS root@deviceIP:/var/root
{% endhighlight %}

### 5. SSH into the device and execute kloader as follows: 

{% highlight c %}
targetDevice:~ root# ./kloaer pwnediBSS
{% endhighlight %}

* Wait for the device to enter DFU mode. If iTunes doesn't recognize it within a 2 minutes, unplug and plug back in, but DO NOT press any buttons. Once iTunes recognizes it, kill iTunes.

### 7. Make sure the desired VALID SHSH blob is in shsh/ECID.shsh. Then restore to the custom iPSW using idevicerestore.

{% highlight c %}
DaytonHasty$ ./idevicerestore -d -w custom.ipsw
{% endhighlight %}

### 8. Enjoy your downgraded device! If you followed all the instructions to a key, you will be alright, if not, you may be forced to restore to the currently signed, possibly non-jailbreakable firmware. 


# Credits

* [@xerub](http://twitter.com/xerub) for this wonderful package

* [@planetbeing](http://twitter.com/planetbeing) for xpwn

* [@wincom](http://twitter.com/winocm) for ios-kexec-utils

* [@libimobiledev](http://twitter.com/libimobiledev) for idevicerestore

* [@citrusui](http://twitter.com/citrusui) for the name

* [@daytonhasty](http://twitter.com/daytonhasty) for the writeup

<center><h3>-dayt0n</h3></center>